jQuery.fn.exists = function(){return this.length>0;}

function randrange(a,b){
    /* returns a random number between >= a && <= b */
    low = Math.min(a,b); high = Math.max(a,b);
    return Math.floor(low + ((high-(low-1)) * Math.random()))
}

function map(x,a,b,c,d){
	return (x-a)/(b-a) * (d-c)+c;
}

function dateDecimal(d){
	return d.getHours() + d.getMinutes()/60 + d.getSeconds()/(60*60);
}

function randrangef(a,b){
    low = Math.min(a,b); high = Math.max(a,b);
    r = low + ((high-(low-1)) * Math.random())
    return  r > high ? high : r
}

function ColorArray(r,g,b){
    if(typeof(r) != 'undefined' && typeof(g) != 'undefined' && typeof(b) != 'undefined'){
        return new Array(r,g,b,1.0);
    }else{
        return new Array(randrange(0,255),randrange(0,255),randrange(0,255),1.0);
    }
}

var x_factor = 0.2;
var y_factor = 3;

function sin(x){
	s = parseInt(Math.sin(x*x_factor)*y_factor);
    return s;
}

var x_factor2 = 0.5;
var y_factor2 = 20;
function sin2(x){
	s = parseInt(Math.sin(x*x_factor2)*y_factor2);
    return s;
}

function Color(r,g,b,a){
    r = (r == undefined ? 255 : r);
    g = (g == undefined ? 255 : g);
    b = (b == undefined ? 255 : b);
    a = (a == undefined ? 255 : a);
    return 'rgba('+r+','+g+','+b+','+a+')';
}

function elapsedDay(sr,ss){
	return ((12 - ss) + (ss - 12));
}

function elapsedNight(sr,ss){
	return ((24 - ss) + (12 - sr));
}


function format(color){
    return 'rgb('+color[0]+','+color[1]+','+color[2]+')';
}
function formatGS(color){
    var gs = parseInt((0.299*color[0] + 0.587*color[1] + 0.114*color[2]));
    return 'rgb('+gs+','+gs+','+gs+')';
}


function epoch(){
	return new Date().getTime()/1000;
}


/* default sunset */
var sunset_states = []

var sunset_index = [{'colors':[
    [ [104,139,242],[242,235,104]],
    [ [115,136,240],[237,228,99]],
    [ [91,104,240],[230,220,87]],
    [ [101,91,240],[232,220,84]],
    [ [114,91,240],[230,217,74]],
    [ [138,91,240],[232,218,65]],
    [ [156,91,240],[240,220,43]],
    [ [173,91,240],[240,201,43]],
    [ [185,91,240],[240,168,43]],
    [ [203,91,240],[247,169,35]],
    [ [228,91,240],[245,134,37]],
    [ [240,91,240],[245,122,39]],
    [ [240,91,218],[245,105,39]],
    [ [240,91,205],[245,87,39]],
    [ [240,91,181],[245,81,39]],
    [ [240,91,151],[245,63,39]],
    [ [240,56,132],[245,39,39]],
    [ [240,57,146],[235,50,50]],
    [ [240,57,167],[227,63,63]],
    [ [240,57,191],[224,72,72]],
    [ [240,57,219],[224,90,90]],
    [ [232,69,216],[230,106,106]],
    [ [245,90,232],[242,126,126]],
    [ [212,87,202],[230,129,129]],
    [ [173,90,167],[194,120,120]],
    [ [153,89,149],[179,86,86]],
    [ [122,85,120],[163,54,54]],
    [ [94,70,93],[148,35,35]],
    [ [64,49,63],[112,38,38]],
    [ [61,54,61],[87,36,36]],
    [ [48,36,48],[59,29,29]],
    [ [48,36,48],[48,30,30]]
    ],'length':30,},
    {'colors':[
    [[104, 139, 242], [240, 231, 104]],
     [[113, 147, 240], [240, 231, 101]],
     [[124, 156, 235], [235, 225, 89]],
     [[135, 164, 232], [232, 220, 93]],
     [[137, 163, 224], [230, 217, 101]],
     [[154, 177, 230], [230, 214, 92]],
     [[170, 190, 235], [240, 222, 87]],
     [[187, 207, 250], [245, 223, 79]],
     [[195, 212, 247], [242, 219, 70]],
     [[210, 222, 247], [240, 213, 62]],
     [[220, 230, 250], [237, 207, 59]],
     [[226, 235, 252], [240, 206, 56]],
     [[230, 237, 250], [235, 198, 52]],
     [[232, 236, 250], [227, 187, 43]],
     [[232, 236, 250], [227, 181, 43]],
     [[232, 235, 250], [227, 175, 43]],
     [[232, 232, 250], [235, 180, 42]],
     [[233, 232, 250], [240, 185, 56]],
     [[235, 232, 250], [240, 173, 57]],
     [[238, 232, 250], [242, 179, 70]],
     [[240, 232, 250], [240, 163, 70]],
     [[242, 232, 250], [245, 166, 76]],
     [[245, 232, 250], [242, 155, 63]],
     [[243, 225, 247], [240, 141, 65]],
     [[244, 226, 245], [240, 127, 67]],
     [[243, 220, 245], [240, 113, 67]],
     [[242, 206, 245], [240, 87, 67]],
     [[233, 185, 237], [235, 87, 70]],
     [[232, 176, 237], [230, 77, 60]],
     [[229, 164, 235], [230, 73, 55]],
     [[218, 166, 224], [224, 67, 49]],
     [[213, 171, 219], [214, 64, 47]],
     [[196, 165, 201], [204, 57, 41]],
     [[190, 167, 194], [194, 48, 35]],
     [[201, 186, 204], [199, 43, 32]],
     [[195, 183, 199], [184, 42, 35]],
     [[187, 183, 189], [176, 42, 37]],
     [[178, 173, 184], [156, 34, 29]],
     [[163, 153, 176], [133, 26, 22]],
     [[155, 140, 173], [122, 23, 20]],
     [[143, 124, 166], [112, 20, 18]],
     [[127, 108, 150], [122, 44, 43]],
     [[106, 96, 138], [115, 48, 48]],
     [[100, 90, 133], [107, 53, 53]],
     [[89, 82, 128], [102, 56, 56]],
     [[83, 76, 122], [94, 56, 56]],
     [[68, 61, 107], [82, 52, 52]],
     [[63, 56, 102], [82, 59, 59]],
     [[63, 56, 102], [77, 54, 54]],
     [[56, 50, 94], [74, 55, 55]],
     [[50, 44, 89], [71, 57, 57]],
     [[42, 36, 82], [71, 57, 57]],
     [[38, 33, 79], [64, 51, 51]],
     [[32, 28, 71], [59, 48, 48]],
     [[30, 27, 69], [56, 48, 48]],
     [[30, 27, 69], [38, 36, 46]],
     [[30, 27, 69], [32, 30, 41]],
     [[30, 27, 69], [29, 27, 41]],
     [[30, 27, 69], [23, 21, 36]],
     [[23, 21, 59], [19, 17, 31]],
     [[21, 19, 56], [15, 14, 26]]
     ],'length':60}
];

// load new sunsets from server
$(function (){
    var data = sunset_index[Math.floor(Math.random() * 2)];
    sunset_states = data.colors
    timelength = data.length;
})
